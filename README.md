我想开发一个微信聊天记录助手，微信作为国民级应用，上面承载了我们太多的生活工作内容。然而，他的检索功能仅支持最基本的字符串检索，经常会发生我们想查询一些内容，却忘记了关键字而找不到的情况。我们想开发一个小软件，可以通过RAG来实现语义化的聊天记录检索。
应用场景如下：
1. 想查找上一次和同学吃的烧烤店叫什么名字，但只记得「烧烤」这个关键词。而聊天记录中的内容是，“我们今晚去吃xx烤肉啊？”，关键词不匹配，导致无法检索。
2. 写月度/年度总结，想知道自己今年大概都做了哪些事情，读了哪些书等等。只能靠自己冥思苦想，但其实可以通过查询聊天记录来有效地总结。
3. 过年给朋友发拜年短信，群发显得千篇一律，不够用心；但自己又没有足够的精力为每位朋友定制化信息。如果能快速通过聊天记录总结出二人一年间的共同经历，就可以很好的总结出一篇诚意满满的拜年祝福。
为了实现以上功能，我需要完成以下工作：
1. 获取聊天记录的明文信息，这一点已经完成。我获取了每一条聊天记录的文本内容，发送时间，收发人等信息。为了方便，我目前只简单考虑了文本信息，忽略了图片/视频/语音等。可以预留接口，未来考虑引入图片、视频、语音等多模态信息，进一步提高检索的准确性。
2. 清洗数据，我发现聊天记录中如果有转发链接，会出现大量无意义的url链接，我把他们都去除了；对于表情信息，我认为他们可以一定程度上体现聊天的情绪，就没有删除；去除常见的停用词。
3. 对聊天记录进行切分，聊天记录具有口语/日常/细碎的特点，我目前是只通过长度来融合聊天记录，比如拼接到长度超过100就切分。但这会导致一个文本块包含多个聊天记录，导致后面的召回排序难度大。
4. 我计划使用bge-m3来对文本进行编码，之后再对query编码，利用dense检索到最相关的5段聊天记录。如果效果不好，也要加上sparse检索，提高对关键词的捕捉能力。
5. 把用户的query和召回得到的聊天记录输入给大模型，总结得到答案
